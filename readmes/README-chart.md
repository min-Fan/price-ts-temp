# Linkol ä»·æ ¼å›¾è¡¨ç”Ÿæˆå™¨

è¿™æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å·¥å…·ï¼Œå¯ä»¥ä»ä½ çš„åŸå§‹Reactç»„ä»¶ä¸­æå–HTMLæ¨¡æ¿ï¼Œè·å–æ•°æ®ï¼Œæ¸²æŸ“å›¾è¡¨ï¼Œå¹¶å¯¼å‡ºä¸ºé«˜è´¨é‡PNGå›¾ç‰‡ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¨ å®Œå…¨å¤åˆ»åŸå§‹ç»„ä»¶çš„æ ·å¼å’Œå¸ƒå±€
- ğŸ“Š ä½¿ç”¨Chart.jsæ¸²æŸ“äº¤äº’å¼å›¾è¡¨
- ğŸ–¼ï¸ æ”¯æŒé«˜åˆ†è¾¨ç‡å›¾ç‰‡å¯¼å‡ºï¼ˆ2xåˆ†è¾¨ç‡ï¼‰
- ğŸ”„ æ”¯æŒæ‰¹é‡ç”Ÿæˆå¤šä¸ªç”¨æˆ·çš„å›¾è¡¨
- ğŸš€ åŸºäºPuppeteerçš„æ— å¤´æµè§ˆå™¨æ¸²æŸ“
- ğŸ“± å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒä¸åŒå±å¹•å°ºå¯¸
- ğŸŒ é›†æˆçœŸå®APIï¼Œæ”¯æŒè‡ªåŠ¨å›é€€åˆ°æ¨¡æ‹Ÿæ•°æ®
- ğŸ‘¤ æ”¯æŒç”¨æˆ·å¤´åƒæ˜¾ç¤ºå’Œä½ç½®æ ‡è®°
- ğŸ“ˆ æ™ºèƒ½ä»·æ ¼åŒºé—´åˆ†æå’Œå¯è§†åŒ–
- ğŸ¯ ç²¾ç¡®çš„å½“å‰ä»·æ ¼ä½ç½®æ ‡è®°

## æ–‡ä»¶ç»“æ„

```
â”œâ”€â”€ chart-generator.ts       # ä¸»è¦ç”Ÿæˆè„šæœ¬
â”œâ”€â”€ template/
â”‚   â””â”€â”€ chart-template.html  # HTMLæ¨¡æ¿æ–‡ä»¶
â”œâ”€â”€ users.json               # ç”¨æˆ·åˆ—è¡¨é…ç½®
â”œâ”€â”€ output/                  # è¾“å‡ºç›®å½•
â”œâ”€â”€ package.json             # ä¾èµ–ç®¡ç†æ–‡ä»¶
â”œâ”€â”€ tsconfig.json            # TypeScripté…ç½®
â””â”€â”€ README-chart.md          # ä½¿ç”¨è¯´æ˜
```

## å®‰è£…ä¾èµ–

```bash
# å®‰è£…ä¾èµ–
npm install

# æˆ–è€…ä½¿ç”¨yarn
yarn install
```

## ä½¿ç”¨æ–¹æ³•

### 1. å•ä¸ªç”¨æˆ·å›¾è¡¨ç”Ÿæˆ

```typescript
import { generateChartImage } from './chart-generator';

// ç”Ÿæˆå•ä¸ªç”¨æˆ·çš„å›¾è¡¨
await generateChartImage('username', './output');
```

### 2. æ‰¹é‡ç”Ÿæˆå›¾è¡¨

```typescript
import { generateMultipleCharts } from './chart-generator';

// æ‰¹é‡ç”Ÿæˆå¤šä¸ªç”¨æˆ·çš„å›¾è¡¨
const users = ['user1', 'user2', 'user3', 'elonmusk'];
await generateMultipleCharts(users, './output');
```

### 3. å‘½ä»¤è¡Œè¿è¡Œ

#### å•ä¸ªç”¨æˆ·ç”Ÿæˆ
```bash
# ç”Ÿæˆå•ä¸ªç”¨æˆ·å›¾è¡¨
npm run single <username>

# æŒ‡å®šè¾“å‡ºç›®å½•
npm run single <username> --out ./custom-output

# ç›´æ¥ä½¿ç”¨ts-node
ts-node chart-generator.ts single <username> -o ./output
```

#### æ‰¹é‡ç”Ÿæˆ
```bash
# ä»users.jsonæ‰¹é‡ç”Ÿæˆ
npm run batch users.json

# æŒ‡å®šè¾“å‡ºç›®å½•
npm run batch users.json --out ./custom-output

# ç›´æ¥ä½¿ç”¨ts-node
ts-node chart-generator.ts batch users.json -o ./output
```

#### å®Œæ•´ç¤ºä¾‹
```bash
# è¿è¡Œå®Œæ•´ç¤ºä¾‹
npm run generate

# å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡å¯ï¼‰
npm run dev
```

## å‘½ä»¤è¡Œå‚æ•°è¯¦è§£

### å•ä¸ªç”¨æˆ·æ¨¡å¼
```bash
ts-node chart-generator.ts single <username> [-o|--out <è¾“å‡ºç›®å½•>]
```

**å‚æ•°è¯´æ˜ï¼š**
- `single`: å•ç”¨æˆ·æ¨¡å¼
- `username`: è¦ç”Ÿæˆå›¾è¡¨çš„ç”¨æˆ·åï¼ˆä¸å«@ç¬¦å·ï¼‰
- `-o, --out`: å¯é€‰ï¼ŒæŒ‡å®šè¾“å‡ºç›®å½•ï¼ˆé»˜è®¤: ./outputï¼‰

**ç¤ºä¾‹ï¼š**
```bash
ts-node chart-generator.ts single elonmusk
ts-node chart-generator.ts single zuck -o ./charts
```

### æ‰¹é‡æ¨¡å¼
```bash
ts-node chart-generator.ts batch <jsonè·¯å¾„> [-o|--out <è¾“å‡ºç›®å½•>]
```

**å‚æ•°è¯´æ˜ï¼š**
- `batch`: æ‰¹é‡æ¨¡å¼
- `jsonè·¯å¾„`: åŒ…å«ç”¨æˆ·åˆ—è¡¨çš„JSONæ–‡ä»¶è·¯å¾„
- `-o, --out`: å¯é€‰ï¼ŒæŒ‡å®šè¾“å‡ºç›®å½•ï¼ˆé»˜è®¤: ./outputï¼‰

**æ”¯æŒçš„JSONæ ¼å¼ï¼š**
```json
// æ ¼å¼1: å­—ç¬¦ä¸²æ•°ç»„
["user1", "user2", "elonmusk"]

// æ ¼å¼2: åŒ…å«userså­—æ®µçš„å¯¹è±¡
{"users": ["user1", "user2", "elonmusk"]}

// æ ¼å¼3: åŒ…å«screen_nameså­—æ®µçš„å¯¹è±¡
{"screen_names": ["user1", "user2", "elonmusk"]}
```

**ç¤ºä¾‹ï¼š**
```bash
ts-node chart-generator.ts batch users.json
ts-node chart-generator.ts batch ./config/users.json -o ./output
```

## APIé›†æˆ

### çœŸå®APIè°ƒç”¨
å·¥å…·ä¼šè‡ªåŠ¨è°ƒç”¨çœŸå®çš„Linkol APIï¼š
```typescript
const response = await fetch(
  `https://intentapi.agtchain.net/kol/api/v4/price/?screen_name=${screenName}`
);
```

### è‡ªåŠ¨å›é€€æœºåˆ¶
- ä¼˜å…ˆä½¿ç”¨çœŸå®APIæ•°æ®
- APIå¤±è´¥æ—¶è‡ªåŠ¨ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
- æ”¯æŒé”™è¯¯çŠ¶æ€ç å¤„ç†
- æ™ºèƒ½æ•°æ®éªŒè¯

### æ•°æ®ç»“æ„
```typescript
interface IGetPriceData {
  current_bin: number;         // å½“å‰ä»·æ ¼åŒºé—´
  current_value: number;       // å½“å‰ä»·æ ¼
  kol: Kol;                    // KOLä¿¡æ¯
  leading_percentage: number;  // é¢†å…ˆç™¾åˆ†æ¯”
}

interface Kol {
  name: string;                // æ˜¾ç¤ºåç§°
  profile_image_url: string;   // å¤´åƒURL
  screen_name: string;         // ç”¨æˆ·å
}
```

## å›¾è¡¨ç‰¹æ€§

### å¯è§†åŒ–å…ƒç´ 
- **ä»·æ ¼åˆ†å¸ƒæ›²çº¿**: åŸºäºChart.jsçš„å¹³æ»‘æŠ˜çº¿å›¾
- **å½“å‰ä»·æ ¼æ ‡è®°**: è“è‰²è™šçº¿ + ç”¨æˆ·å¤´åƒ
- **æ™ºèƒ½å®šä½**: è‡ªåŠ¨è®¡ç®—ä»·æ ¼åœ¨åŒºé—´ä¸­çš„ç²¾ç¡®ä½ç½®
- **é«˜åˆ†è¾¨ç‡**: 2xç¼©æ”¾ç¡®ä¿å›¾ç‰‡è´¨é‡

### æ ·å¼ç‰¹æ€§
- **å“åº”å¼è®¾è®¡**: æ”¯æŒä¸åŒå±å¹•å°ºå¯¸
- **ç°ä»£åŒ–UI**: åœ†è§’è¾¹æ¡†ã€é˜´å½±æ•ˆæœ
- **å“ç‰Œè‰²å½©**: è“è‰²ä¸»é¢˜é…è‰²æ–¹æ¡ˆ
- **å­—ä½“ä¼˜åŒ–**: ç³»ç»Ÿå­—ä½“æ ˆï¼Œç¡®ä¿è·¨å¹³å°ä¸€è‡´æ€§

### å¤´åƒæ˜¾ç¤º
- **åœ†å½¢å¤´åƒ**: ç™½è‰²è¾¹æ¡† + è“è‰²è½®å»“
- **ç²¾ç¡®å®šä½**: åŸºäºå½“å‰ä»·æ ¼åœ¨å›¾è¡¨ä¸­çš„ä½ç½®
- **è·¨åŸŸæ”¯æŒ**: æ”¯æŒå¤–éƒ¨å›¾ç‰‡æº
- **é”™è¯¯å¤„ç†**: å¤´åƒåŠ è½½å¤±è´¥æ—¶çš„ä¼˜é›…é™çº§

## è¾“å‡ºé…ç½®

### æ–‡ä»¶å‘½å
ç”Ÿæˆçš„å›¾ç‰‡æ–‡ä»¶å‘½åæ ¼å¼ï¼š
```
@username_linkol_price_YYYY-MM-DD.png
```

**ç¤ºä¾‹ï¼š**
- `@elonmusk_linkol_price_2025-01-18.png`
- `@zuck_linkol_price_2025-01-18.png`

### è¾“å‡ºç›®å½•
- **é»˜è®¤è·¯å¾„**: `./output`
- **è‡ªå®šä¹‰è·¯å¾„**: é€šè¿‡ `-o` æˆ– `--out` å‚æ•°æŒ‡å®š
- **è‡ªåŠ¨åˆ›å»º**: è¾“å‡ºç›®å½•ä¸å­˜åœ¨æ—¶è‡ªåŠ¨åˆ›å»º

### å›¾ç‰‡è´¨é‡
- **åˆ†è¾¨ç‡**: åŸå§‹å°ºå¯¸çš„2å€
- **æ ¼å¼**: PNGæ ¼å¼ï¼Œæ”¯æŒé€æ˜èƒŒæ™¯
- **å°ºå¯¸**: 800x600åƒç´ ï¼ˆå¯è‡ªå®šä¹‰ï¼‰

## é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯ç±»å‹
1. **APIè¯·æ±‚å¤±è´¥**: ç½‘ç»œé”™è¯¯ã€æœåŠ¡å™¨é”™è¯¯
2. **æ•°æ®æ ¼å¼æ— æ•ˆ**: APIè¿”å›æ•°æ®ä¸ç¬¦åˆé¢„æœŸ
3. **æ–‡ä»¶ç³»ç»Ÿé”™è¯¯**: è¾“å‡ºç›®å½•æƒé™é—®é¢˜
4. **æµè§ˆå™¨å¯åŠ¨å¤±è´¥**: Puppeteeré…ç½®é—®é¢˜

### é”™è¯¯æ¢å¤ç­–ç•¥
- **APIå¤±è´¥**: è‡ªåŠ¨å›é€€åˆ°æ¨¡æ‹Ÿæ•°æ®
- **å•ä¸ªç”¨æˆ·å¤±è´¥**: ç»§ç»­å¤„ç†å…¶ä»–ç”¨æˆ·
- **æ‰¹é‡å¤„ç†**: è®°å½•å¤±è´¥ç”¨æˆ·ï¼Œå®Œæˆå…¶ä»–ç”¨æˆ·

### æ—¥å¿—è¾“å‡º
- **è¿›åº¦æ˜¾ç¤º**: å®æ—¶æ˜¾ç¤ºå¤„ç†è¿›åº¦
- **é”™è¯¯è¯¦æƒ…**: è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œå †æ ˆ
- **æˆåŠŸç¡®è®¤**: æ¯ä¸ªæˆåŠŸç”Ÿæˆçš„å›¾è¡¨ç¡®è®¤

## æ€§èƒ½ä¼˜åŒ–

### å¹¶å‘æ§åˆ¶
- **è¯·æ±‚é—´éš”**: æ‰¹é‡å¤„ç†æ—¶1ç§’é—´éš”
- **å†…å­˜ç®¡ç†**: æ¯ä¸ªå›¾è¡¨å®Œæˆåå…³é—­æµè§ˆå™¨
- **èµ„æºæ¸…ç†**: è‡ªåŠ¨æ¸…ç†ä¸´æ—¶èµ„æº

### æµè§ˆå™¨ä¼˜åŒ–
```typescript
const browser = await puppeteer.launch({
  headless: "new",           // ä½¿ç”¨æ–°ç‰ˆæ— å¤´æ¨¡å¼
  executablePath: "/Applications/Google Chrome.app/Contents/MacOS/Google Chrome",
  args: [
    "--no-sandbox",          // ç¦ç”¨æ²™ç®±
    "--disable-setuid-sandbox"  // ç¦ç”¨setuidæ²™ç®±
  ]
});
```

### æ¸²æŸ“ä¼˜åŒ–
- **ç­‰å¾…ç­–ç•¥**: æ™ºèƒ½ç­‰å¾…å›¾è¡¨æ¸²æŸ“å®Œæˆ
- **è¶…æ—¶æ§åˆ¶**: 2ç§’æ¸²æŸ“ç­‰å¾…æ—¶é—´
- **ç”»å¸ƒä¼˜åŒ–**: é«˜åˆ†è¾¨ç‡ç”»å¸ƒè®¾ç½®

## è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹APIç«¯ç‚¹
åœ¨ `chart-generator.ts` ä¸­ä¿®æ”¹ `getPriceData` å‡½æ•°ï¼š
```typescript
async function getPriceData(screenName: string): Promise<IGetPriceData> {
  // æ›¿æ¢ä¸ºä½ çš„å®é™…APIè°ƒç”¨
  const response = await fetch(`/kol/api/v4/price/?screen_name=${screenName}`);
  return response.json();
}
```

### è‡ªå®šä¹‰è¾“å‡ºæ ¼å¼
ä¿®æ”¹æ–‡ä»¶åç”Ÿæˆé€»è¾‘ï¼š
```typescript
const fileName = `custom_${screenName}_${Date.now()}.png`;
```

### è°ƒæ•´å›¾è¡¨æ ·å¼
åœ¨ `chart-template.html` ä¸­ä¿®æ”¹CSSæ ·å¼å’ŒChart.jsé…ç½®ã€‚

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. Puppeteerå®‰è£…å¤±è´¥
```bash
# å°è¯•ä½¿ç”¨unsafe-perm
npm install puppeteer --unsafe-perm=true

# æˆ–è€…ä½¿ç”¨ç³»ç»ŸChrome
export PUPPETEER_EXECUTABLE_PATH="/usr/bin/google-chrome"
```

#### 2. å†…å­˜ä¸è¶³
- å‡å°‘å¹¶å‘å¤„ç†çš„ç”¨æˆ·æ•°é‡
- å¢åŠ ç³»ç»Ÿå†…å­˜
- ä½¿ç”¨ `--max-old-space-size` å‚æ•°

#### 3. å›¾ç‰‡è´¨é‡
- æ£€æŸ¥è¾“å‡ºè·¯å¾„æ˜¯å¦æœ‰å†™å…¥æƒé™
- ç¡®è®¤ç”»å¸ƒåˆ†è¾¨ç‡è®¾ç½®
- éªŒè¯Chart.jsç‰ˆæœ¬å…¼å®¹æ€§

#### 4. APIè°ƒç”¨å¤±è´¥
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- éªŒè¯APIç«¯ç‚¹URL
- ç¡®è®¤APIå¯†é’¥å’Œæƒé™

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### 1. è°ƒæ•´ç­‰å¾…æ—¶é—´
```typescript
// æ ¹æ®å›¾è¡¨å¤æ‚åº¦è°ƒæ•´
await page.waitForTimeout(2000); // é»˜è®¤2ç§’
```

#### 2. ä½¿ç”¨GPUåŠ é€Ÿ
```typescript
args: [
  "--disable-gpu",           // ç¦ç”¨GPUï¼ˆæŸäº›ç³»ç»Ÿï¼‰
  "--enable-gpu-rasterization" // å¯ç”¨GPUå…‰æ …åŒ–
]
```

#### 3. é›†ç¾¤æ¨¡å¼
å¯¹äºå¤§é‡ç”¨æˆ·ï¼Œè€ƒè™‘ä½¿ç”¨é›†ç¾¤æ¨¡å¼ï¼š
```typescript
// åˆ†æ‰¹å¤„ç†ï¼Œæ¯æ‰¹10ä¸ªç”¨æˆ·
const batchSize = 10;
for (let i = 0; i < users.length; i += batchSize) {
  const batch = users.slice(i, i + batchSize);
  await Promise.all(batch.map(user => generateChartImage(user, outputPath)));
}
```

## å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„
```
â”œâ”€â”€ chart-generator.ts       # ä¸»è¦é€»è¾‘
â”œâ”€â”€ template/                # æ¨¡æ¿æ–‡ä»¶
â”‚   â””â”€â”€ chart-template.html  # HTMLæ¨¡æ¿
â”œâ”€â”€ types/                   # ç±»å‹å®šä¹‰
â”œâ”€â”€ utils/                   # å·¥å…·å‡½æ•°
â””â”€â”€ output/                  # è¾“å‡ºç›®å½•
```

### æ‰©å±•åŠŸèƒ½
1. **æ·»åŠ æ–°çš„å›¾è¡¨ç±»å‹**: ä¿®æ”¹HTMLæ¨¡æ¿å’Œæ¸²æŸ“é€»è¾‘
2. **æ”¯æŒæ›´å¤šæ•°æ®æº**: æ‰©å±• `getPriceData` å‡½æ•°
3. **è‡ªå®šä¹‰æ ·å¼**: ä¿®æ”¹CSSå’ŒChart.jsé…ç½®
4. **æ‰¹é‡å¤„ç†ä¼˜åŒ–**: å®ç°å¹¶è¡Œå¤„ç†å’Œè¿›åº¦è·Ÿè¸ª

### æµ‹è¯•
```bash
# å¼€å‘æ¨¡å¼
npm run dev

# æ„å»º
npm run build

# è¿è¡Œæµ‹è¯•
npm test
```

## è®¸å¯è¯

MIT License

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªå·¥å…·ï¼

## æ›´æ–°æ—¥å¿—

### v1.0.0
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- æ”¯æŒå•ä¸ªå’Œæ‰¹é‡å›¾è¡¨ç”Ÿæˆ
- é›†æˆçœŸå®APIå’Œæ¨¡æ‹Ÿæ•°æ®
- é«˜åˆ†è¾¨ç‡å›¾ç‰‡å¯¼å‡º
- å®Œæ•´çš„CLIæ”¯æŒ
